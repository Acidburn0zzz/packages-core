# Note: build this package with --force flag
# Note: keep insync with mesa pkg
#
# Maintainer: Clittle <philm@manjaro.org>
# Maintainer: Roland Singer <roland@manajro.org>

pkgname=('mesa-libgl')
pkgver=9.1.1
pkgrel=1
arch=('i686' 'x86_64')
depends=('mhwd' "mesa=${pkgver}")
pkgdesc="Mesa 3-D graphics library and DRI software rasterizer"
provides=("libgl=${pkgver}")
replaces=('libgl')
install=libgl.install
url="http://mesa3d.sourceforge.net"
license=('custom')
source=(http://mirror.us.leaseweb.net/archlinux/extra/os/$CARCH/$pkgname-$pkgver-$pkgrel-$CARCH.pkg.tar.xz)
if [ "$CARCH" = "i686" ]; then
   sha256sums=('d0a4d2d16e4ec8ce90bdd0c1713f6c0143d9ccaa0f9a552beda7526d8c0150cd')
else
   sha256sums=('ada3e3a479b14d0680d946e358a6790a0db3183f60f6a66bb4a967134b79c119')
fi

package() {
  cp -rPf usr ${pkgdir}
  mv "${pkgdir}/usr/lib/libGL.so.1.2.0" "${pkgdir}/usr/lib/libGL.so.mesa"
  rm "${pkgdir}/usr/lib/libGL.so.1"
  rm "${pkgdir}/usr/lib/libGL.so"
  rm "${pkgdir}/usr/lib/xorg/modules/extensions/libglx.so"
}

